# チーム開発の流れ（Issue駆動開発・Git/GitHubワークフロー）

本プロジェクトでは，作業を整理しレビューを円滑にするため，タスクを**Issue（課題）単位**で管理して開発を進めます．
また，`main`ブランチへの直接のプッシュ（編集）はGitHub側の設定で無効にされており，**必ずPull Request（プルリク）経由でのみマージ可能**となっています．
> このルールは生成AIによって作成されました．そのため，開発の状況に応じて変更される可能性は十分にあります．

## 1. Issueの種類とブランチ構造

本プロジェクトでは，Issueを以下の3種類に分けて運用します．

### 🍎 main issue（大きな機能単位）
- **目的**: 搭載したい1つの大きな機能を定義します．（例：「プレイヤーの基本アクション実装」「インベントリシステム」）
- **ブランチ名**: `feature/機能名/#main_issue番号` （例: `feature/player-action/#10`）
- **マージ先**: `main` ブランチへマージが可能です．
- **特徴**:
  - このIssueを達成するために，複数の `sub issue` をぶら下げます．
  - 基本的にこのブランチに直接修正コミットを行うことも可能ですが，推奨されません．

### 🍏 sub issue（最小の作業・PR単位）
- **目的**: `main issue` を達成するために必要な，細かく分割された最小単位のタスクです．（例：「ジャンプ処理の実装」「アニメーション設定」）
- **ブランチ名**: `subfeature/機能名/#sub_issue番号` （例: `subfeature/player-jump/#12`）
- **マージ先**: 親となる `main issue` のブランチ（`feature/〜`）へのみマージが可能です．`main`へ直接マージすることはできません．
- **特徴**: これ自身がさらに `sub issue` を持つことも可能ですが，管理が複雑になるためあまり推奨しません．

### 🐛 debug issue（バグ修正）
- **目的**: 発生したエラーやバグを解決するためのIssueです．
- **ブランチ名**: `debug/修正内容/#debug_issue番号` （例: `debug/fix-null-reference/#15`）
- **マージ先**: `main` ブランチ，または `main issue` のブランチ（`feature/〜`）に対してマージが可能です．
- **特徴**: `sub issue` は持ちません．1つのエラー（または1つの課題を解決するために必要な複数の関連エラー）だけに対処する単発のIssueです．

---

## 2. 開発の具体的なフロー（手順）

新しい機能を作る時の具体的な手順は以下の通りです．

### Step 1. main issueの切り出しとアサイン
1. GitHubのIssues上でゲームの必要な機能を `main issue` として作成します．
2. その `main issue` の内，作成したいものに対して自身で**Assign（アサイン）**します．

### Step 2. sub issueへの分割とブランチ作成
1. **[最初のアサイン者]** は，`main issue` の画面を開き，右側メニューの「**Create sub-issue**」機能や，本文中のチェックボックスから直接 `sub issue` を作成（切り分け）し，Main Issueの子として紐付けます．
2. **[最初のアサイン者]** は，GitHub上で `main issue` 用の親ブランチ（`feature/機能名/#main_issue番号`）を作成します．

### Step 3. sub issueの担当と作業開始
1. チームメンバーは，自分が担当する `sub issue` に自分をアサインします（ここは1つのIssueにつき1人のアサインが望ましいです）．
2. アサインした人は，ローカルPCで親ブランチから `sub issue` に対応する作業ブランチ（`subfeature/機能名/#sub_issue番号`）を作成します．
3. Unityで開発を行い，キリの良いところでコミットします．

### Step 4. リモートへプッシュ
1. 自分の作業ブランチ（`subfeature/〜`）をリモートにプッシュします．

### Step 5. プルリクエスト（PR）の作成と自動フォーマット
1. 作業が終わったら，GitHubの画面からプルリクエストを作成します．
   - **マージ先**: `main issue` のブランチ（`feature/〜`）を指定してPRを作成してください．（間違えて `main` 向けに出さないよう注意！）
2. PRの作成画面を開くと**自動的にテンプレートが挿入されます**．テンプレート（[Template.md](../PR/Template.md)も参照）の指示に従って「どのIssueを解決したのか」「どうやって確認するのか」を分かりやすく記載し，**レビュアーを1人以上指定（Reviewers）**します．
3. 💡 **【重要】フォーマッタの自動実行**: PRを作成（または更新のためプッシュ）すると，GitHub Actionsが裏で動き，コードの自動整形コミットがBotによってあなたのPRに追加されます．この後も手元のPCでPRの続きを開発する場合は，**必ず `git pull` をしてBotの整形変更を取り込んでから**再開してください．

### Step 6. 修正と承認（Approve）
1. レビュアーはコードを確認し，コメントを残します．
2. 作成者はコメントを反映して再度プッシュします（PRは自動更新されます）．
3. 問題がなくなったら，レビュアーが「Approve（承認）」を付与します．

### Step 7. マージ
1. **「1人以上の承認（Approve）」がある場合のみ**，PR作成者自身が「Merge pull request」を押してマージします．
2. 不要になった `subfeature/〜` ブランチは削除します．

> 💡 全ての `sub issue` がマージされ，`main issue` のブランチ（`feature/〜`）が完成したら，最後にそのブランチから `main` ブランチへ向けて巨大なPRを出してマージします！
