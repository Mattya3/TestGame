# レビューのプロセスと方法

他のメンバーのPull Request（PR）をチェック（レビュー）し、安全にメインブランチに合流させるためのルールと具体的な方法です。

## 1. レビューのスタンスと心構え
- コメントは常に **客観的** であることを意識してください。
- **言い回しの作法**:
  - 「〜しろ」「〜直して」といった命令形ではなく、「〜してもらえませんか？」「〜という変更をお願いします」といった **依頼** の形をとること。
  - 問題を指摘する際は、相手を責めるような書き方（例: 「なんでこんな書き方してるんですか？」）は避け、コードや仕組み自体にフォーカスして建設的に伝えてください。
- **賞賛コメント**: 良い実装、賢い工夫、綺麗なコードに対する「ここ良いですね！」といったポジティブな箇所へのコメントも可能・大歓迎です（むしろ推奨）。
- **責任**: コメントを残す者は、そのPRを承認する責任を負います。曖昧なままLGTM(良さそうに見える)を押すことは推奨されません。

## 2. コメント時の検討（レビューの方針）
コメントを残す前に、以下の3つのどのアプローチを取るか検討してください。
1. **見送る (レビューしない)**: 単なる好みの問題に過ぎない場合などは、指摘を見送ります。
2. **提案する (レビューする)**: 明確なバグや改善点がある場合は、具体的な解決策とともに客観的に提案します。
3. **議論する (レビューではなく話し合う)**: そのPRだけでは完結しない大きな設計の話や、テキスト（GitHub上）では上手く伝わらない場合は、直接会話による議論の場を設けます。

## 3. コメントのプレフィックス (分類)
コメントの意図や重要度が伝わりやすいよう、文章の先頭に以下の**プレフィックス表記**を入れることを推奨します。

| プレフィックス | 意味・用途 |
|---|---|
| `[MUST]` | 承認するために必ず対処するべき変更。絶対に直してほしいバグやルール違反など。 |
| `[SHOULD]` | 明らかに改善するべき変更、または強く推奨する改善案。変更を無視する場合は相応の理由を提示する必要がある。 | 
| `[COULD]` | コードを改善できる可能性がある任意の提案。変更を無視しても問題ない。 |
| `[WANT]` | 完全な好みに基づく(指導的な意味合いをもつ)要望や仕様変更。変更を無視しても問題ない。 |

## 4. 変更依頼コメントの基本構成
レビュアーに変更を要求する場合、コメント内に以下の3要素を可能な限り含めてください。説得力が生まれ、直す側も意図がわかりやすくなります。

1. **依頼**: 何をして欲しいのかを「1文」で明確に書く。
2. **理由**: なぜその変更や修正が必要なのかを「1〜2文」で書く。
3. **結果**: その変更を行うことで「何が達成できるのか」を書く。

**【コメント例】**
> **[SHOULD]** ここのpublicフィールドを `[SerializeField] private` に変更していただけませんか？（**依頼**）
> Unityの仕様上、他のスクリプトから意図せず値が書き換えられてしまう危険性があるためです。（**理由**）
> これを修正することで、意図しないバグを防ぎ、より安全なクラスになります。（**結果**）

## 5. レビュー時の着眼点
レビュアーは以下のポイントを意識して変更内容を確認します。

1. **要件を満たしているか？**
   - 対応するIssue（特に完了条件）を読み、今回のPRでそれが達成されているか確認します。
2. **実際に動くか？（ローカルでの動作確認）**
   - PRのブランチを手元に `git pull`（または `fetch` & `checkout`）し、Unityエディタで実際に動かしてエラーが出ないかテストします。
   - ※小さなテキスト変更などであればWeb上のコードを見るだけでもOKですが、C#の複雑な処理やSceneの変更はなるべく手元で動かしてください。
3. **可読性とルール違反がないか？**
   - C#コーディング規約（`CSharp.md`）やUnityのルール（`UnityRules.md`）に違反していないか。（`public`の乱用や激しい重い処理など）
   - 不要な `Debug.Log` が残っていないか。

## 6. 効果的な修正プロセスとマージ
- **修正の対応方法**: レビュアーから指摘を受けた作成者は、**新しくPRを作り直す必要はありません**。手元でコードを修正し、同じ作業ブランチに追加で `git commit` & `git push` すれば、自動的に同じPRの画面に変更が反映されます。
- **Approve（承認）の必須人数**: 設定しているルールに従い、最低 **1人** のレビュアーから **Approve (承認)** をもらう必要があります。
- **マージ担当者**: 全ての指摘が解消し、Approveが出た後、**PRの作成者本人**または**レビュアー**が「Merge pull request」を押して合流させます。
- **ブランチの整理**: マージが完了したら、作業に使っていた古いブランチは（GitHub上から）忘れずに削除してください。
